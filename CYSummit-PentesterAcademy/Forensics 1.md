# Forensics 1 - Volatility 2 for Linux

Special Thanks to [Pentester Academy](https://www.pentesteracademy.com/) for creating this challenge in the CTF... I thought I was good at volatility but you bet I ain't lol!

### 1.	What was the PID of process rsyslog?	[VERIFIED]

We are presented with a linux memory dump so trying to run the standard arguments which trigger the windows plugins will not work, such as `imageinfo` and `pslist`. We can first get an idea of the available arguments by running the tool with the `-h`
flag.

```
 Supported Plugin Commands:

            imagecopy       Copies a physical address space out as a raw DD image
            limeinfo        Dump Lime file format information
            linux_apihooks  Checks for userland apihooks
            linux_arp       Print the ARP table
            linux_aslr_shift        Automatically detect the Linux ASLR shift
            linux_banner    Prints the Linux banner information 
            linux_bash      Recover bash history from bash process memory
            linux_bash_env  Recover a process' dynamic environment variables
            linux_bash_hash Recover bash hash table from bash process memory
            linux_check_afinfo      Verifies the operation function pointers of network protocols
            linux_check_creds       Checks if any processes are sharing credential structures
            linux_check_fop Check file operation structures for rootkit modifications
            linux_check_idt Checks if the IDT has been altered 
            linux_check_inline_kernel       Check for inline kernel hooks
            linux_check_modules     Compares module list to sysfs info, if available
            linux_check_syscall     Checks if the system call table has been altered 
            linux_check_tty Checks tty devices for hooks
            linux_cpuinfo   Prints info about each active processor
            linux_dentry_cache      Gather files from the dentry cache
            linux_dmesg     Gather dmesg buffer
            linux_dump_map  Writes selected memory mappings to disk 
            linux_dynamic_env       Recover a process' dynamic environment variables
            linux_elfs      Find ELF binaries in process mappings
            linux_enumerate_files   Lists files referenced by the filesystem cache
            linux_find_file Lists and recovers files from memory
            linux_getcwd    Lists current working directory of each process
            linux_hidden_modules    Carves memory to find hidden kernel modules
            linux_ifconfig  Gathers active interfaces
            linux_info_regs It's like 'info registers' in GDB. It prints out all the
            linux_iomem     Provides output similar to /proc/iomem
            linux_kernel_opened_files       Lists files that are opened from within the kernel
            linux_keyboard_notifiers        Parses the keyboard notifier call chain
            linux_ldrmodules        Compares the output of proc maps with the list of libraries from libdl
            linux_library_list      Lists libraries loaded into a process 
            linux_librarydump       Dumps shared libraries in process memory to disk
            linux_list_raw  List applications with promiscuous sockets
            linux_lsmod     Gather loaded kernel modules
            linux_lsof      Lists file descriptors and their path
            linux_malfind   Looks for suspicious process mappings
            linux_memmap    Dumps the memory map for linux tasks
            linux_moddump   Extract loaded kernel modules
            linux_mount     Gather mounted fs/devices
            linux_mount_cache       Gather mounted fs/devices from kmem_cache
            linux_netfilter Lists Netfilter hooks
            linux_netscan   Carves for network connection structures
            linux_netstat   Lists open sockets
            linux_pidhashtable      Enumerates processes through the PID hash table
            linux_pkt_queues        Writes per-process packet queues out to disk
            linux_plthook   Scan ELF binaries' PLT for hooks to non-NEEDED images
            linux_proc_maps Gathers process memory maps
            linux_proc_maps_rb      Gathers process maps for linux through the mappings red-black tree
            linux_procdump  Dumps a process's executable image to disk
            linux_process_hollow    Checks for signs of process hollowing
            linux_psaux     Gathers processes along with full command line and start time
            linux_psenv     Gathers processes along with their static environment variables
            linux_pslist    Gather active tasks by walking the task_struct->task list
            linux_pslist_cache      Gather tasks from the kmem_cache
            linux_psscan    Scan physical memory for processes 
            linux_pstree    Shows the parent/child relationship between processes
            linux_psxview   Find hidden processes with various process listings
            linux_recover_filesystem        Recovers the entire cached file system from memory
            linux_route_cache       Recovers the routing cache from memory 
            linux_sk_buff_cache     Recovers packets from the sk_buff kmem_cache
            linux_slabinfo  Mimics /proc/slabinfo on a running machine
            linux_strings   Match physical offsets to virtual addresses (may take a while, VERY verbose)
            linux_threads   Prints threads of processes 
            linux_tmpfs     Recovers tmpfs filesystems from memory
            linux_truecrypt_passphrase      Recovers cached Truecrypt passphrases 
            linux_vma_cache Gather VMAs from the vm_area_struct cache
            linux_volshell  Shell in the memory image
            linux_yarascan  A shell in the Linux memory image
            mbrparser       Scans for and parses potential Master Boot Records (MBRs) 
            patcher         Patches memory based on page scans
            raw2dmp         Converts a physical memory sample to a windbg crash dump
            vmwareinfo      Dump VMware VMSS/VMSN information
```

To obtain the PID, we will follow the same methodology as on windows, to get a full process list using the `pslist` flag.

```
root@attackdefense:~# vol.py -f memory_dump.img linux_pslist
Volatility Foundation Volatility Framework 2.6.1
Offset             Name                 Pid             PPid            Uid             Gid    DTB                Start Time
------------------ -------------------- --------------- --------------- --------------- ------ ------------------ ----------
0xffff9636db644440 systemd              1               0               0               0      0x000000001adf6000 0
0xffff9636db6416c0 kthreadd             2               0               0               0      ------------------ 0
0xffff9636db642d80 kworker/0:0H         4               2               0               0      ------------------ 0
0xffff9636db640000 kworker/u2:0         5               2               0               0      ------------------ 0
0xffff9636db6516c0 mm_percpu_wq         6               2               0               0      ------------------ 0
0xffff9636db655b00 ksoftirqd/0          7               2               0               0      ------------------ 0
0xffff9636db652d80 rcu_sched            8               2               0               0      ------------------ 0
0xffff9636db650000 rcu_bh               9               2               0               0      ------------------ 0
0xffff9636db654440 migration/0          10              2               0               0      ------------------ 0
0xffff9636db678000 watchdog/0           11              2               0               0      ------------------ 0
0xffff9636db67c440 cpuhp/0              12              2               0               0      ------------------ 0
0xffff9636db6796c0 kdevtmpfs            13              2               0               0      ------------------ 0
0xffff9636db67db00 netns                14              2               0               0      ------------------ 0
0xffff9636db67ad80 rcu_tasks_kthre      15              2               0               0      ------------------ 0
0xffff9636db6dad80 kauditd              16              2               0               0      ------------------ 0
0xffff9636db6d8000 khungtaskd           17              2               0               0      ------------------ 0
0xffff9636db6dc440 oom_reaper           18              2               0               0      ------------------ 0
0xffff9636db6d96c0 writeback            19              2               0               0      ------------------ 0
0xffff9636db6ddb00 kcompactd0           20              2               0               0      ------------------ 0
0xffff9636db744440 ksmd                 21              2               0               0      ------------------ 0
0xffff9636db7416c0 crypto               22              2               0               0      ------------------ 0
0xffff9636db745b00 kintegrityd          23              2               0               0      ------------------ 0
0xffff9636db742d80 kblockd              24              2               0               0      ------------------ 0
0xffff9636db740000 ata_sff              25              2               0               0      ------------------ 0
0xffff9636db7edb00 md                   26              2               0               0      ------------------ 0
0xffff9636db7ead80 edac-poller          27              2               0               0      ------------------ 0
0xffff9636db7e8000 devfreq_wq           28              2               0               0      ------------------ 0
0xffff9636db7ec440 watchdogd            29              2               0               0      ------------------ 0
0xffff9636db7e96c0 kworker/u2:1         30              2               0               0      ------------------ 0
0xffff9636daf296c0 kswapd0              33              2               0               0      ------------------ 0
0xffff9636daf2db00 ecryptfs-kthrea      34              2               0               0      ------------------ 0
0xffff9636cf7a8000 kthrotld             76              2               0               0      ------------------ 0
0xffff9636cf7ac440 acpi_thermal_pm      77              2               0               0      ------------------ 0
0xffff9636cf7a96c0 kworker/u2:2         78              2               0               0      ------------------ 0
0xffff9636cf7adb00 scsi_eh_0            79              2               0               0      ------------------ 0
0xffff9636cf7aad80 scsi_tmf_0           80              2               0               0      ------------------ 0
0xffff9636cf782d80 scsi_eh_1            81              2               0               0      ------------------ 0
0xffff9636cf785b00 scsi_tmf_1           82              2               0               0      ------------------ 0
0xffff9636cf7816c0 kworker/u2:3         83              2               0               0      ------------------ 0
0xffff9636cf77db00 ipv6_addrconf        87              2               0               0      ------------------ 0
0xffff9636cf780000 kstrp                96              2               0               0      ------------------ 0
0xffff9636cf77c440 charger_manager      113             2               0               0      ------------------ 0
0xffff9636cf744440 kworker/0:1H         153             2               0               0      ------------------ 0
0xffff9636cf7696c0 scsi_eh_2            154             2               0               0      ------------------ 0
0xffff9636cf76db00 scsi_tmf_2           155             2               0               0      ------------------ 0
0xffff9636cf765b00 jbd2/sda1-8          178             2               0               0      ------------------ 0
0xffff9636cf7616c0 ext4-rsv-conver      179             2               0               0      ------------------ 0
0xffff9636cf752d80 systemd-journal      216             1               0               0      0x000000001af3a000 0
0xffff9636cf750000 systemd-udevd        239             1               0               0      0x000000001adf0000 0
0xffff9636cf76c440 iprt-VBoxWQueue      267             2               0               0      ------------------ 0
0xffff9636cf764440 ttm_swap             295             2               0               0      ------------------ 0
0xffff9636cf69c440 jbd2/sda4-8          444             2               0               0      ------------------ 0
0xffff9636cf784440 ext4-rsv-conver      445             2               0               0      ------------------ 0
0xffff9636daf2c440 jbd2/sda2-8          448             2               0               0      ------------------ 0
0xffff9636cf69db00 ext4-rsv-conver      449             2               0               0      ------------------ 0
0xffff9636cf755b00 systemd-timesyn      491             1               100             102    0x000000001f03a000 0
0xffff9636cf778000 systemd-logind       617             1               0               0      0x000000001090a000 0
0xffff9636cf6996c0 acpid                629             1               0               0      0x000000001af3c000 0
0xffff9636cf698000 avahi-daemon         632             1               111             120    0x0000000012308000 0
0xffff9636cf7516c0 cupsd                635             1               0               0      0x00000000128de000 0
0xffff9636d28ec440 avahi-daemon         640             632             111             120    0x000000001a20a000 0
0xffff9636daf0db00 cron                 642             1               0               0      0x0000000012404000 0
0xffff9636cf75db00 accounts-daemon      643             1               0               0      0x000000001240a000 0
0xffff9636cf7796c0 rsyslogd             644             1               104             108    0x0000000012402000 0
0xffff9636daf2ad80 dbus-daemon          645             1               106             110    0x0000000012450000 0
0xffff9636d70dad80 NetworkManager       656             1               0               0      0x0000000013b4c000 0
0xffff9636d70dc440 cups-browsed         658             1               0               0      0x0000000013b44000 0
0xffff9636d0514440 dbus                 664             635             7               7      0x000000001053a000 0
0xffff9636d05116c0 dbus                 665             635             7               7      0x000000001055e000 0
0xffff9636d0515b00 dbus                 666             635             7               7      0x00000000142f8000 0
0xffff9636d28e96c0 polkitd              780             1               0               0      0x00000000143c2000 0
0xffff9636de5096c0 lightdm              802             1               0               0      0x00000000109d2000 0
0xffff9636cf75ad80 kworker/0:4          804             2               0               0      ------------------ 0
0xffff9636d426db00 Xorg                 833             802             0               0      0x000000001a250000 0
0xffff9636d70d96c0 sshd                 834             1               0               0      0x000000001e68e000 0
0xffff9636de50c440 dhclient             844             656             0               0      0x000000001e52e000 0
0xffff9636daf08000 dnsmasq              857             656             -               30     0x000000001e58c000 0
0xffff9636d28e8000 lightdm              1073            802             0               0      0x00000000104ee000 0
0xffff9636d3adc440 whoopsie             1103            1               109             117    0x0000000017248000 0
0xffff9636d73496c0 agetty               1125            1               0               0      0x00000000173ec000 0
0xffff9636d73d4440 rtkit-daemon         1151            1               118             126    0x00000000140da000 0
0xffff9636d73d16c0 upowerd              1168            1               0               0      0x00000000138b0000 0
0xffff9636d3814440 colord               1181            1               113             123    0x00000000138c4000 0
0xffff9636da0716c0 systemd              1222            1               1000            1000   0x000000001081e000 0
0xffff9636da075b00 (sd-pam)             1224            1222            1000            1000   0x000000001251e000 0
0xffff9636cf762d80 gnome-keyring-d      1292            1               1000            1000   0x000000001087c000 0
0xffff9636d4090000 upstart              1296            1073            1000            1000   0x00000000139a6000 0
0xffff9636d73bdb00 upstart-udev-br      1379            1296            1000            1000   0x0000000013924000 0
0xffff9636d73bad80 dbus-daemon          1390            1296            1000            1000   0x00000000138c6000 0
0xffff9636d734ad80 window-stack-br      1402            1296            1000            1000   0x00000000141a4000 0
0xffff9636d229ad80 bamfdaemon           1444            1296            1000            1000   0x00000000139b6000 0
0xffff9636d73bc440 upstart-dbus-br      1450            1296            1000            1000   0x0000000013910000 0
0xffff9636d41616c0 upstart-dbus-br      1452            1296            1000            1000   0x0000000013914000 0
0xffff9636d4160000 upstart-file-br      1454            1296            1000            1000   0x00000000138e6000 0
0xffff9636daf0c440 gvfsd                1458            1296            1000            1000   0x0000000010898000 0
0xffff9636d28ead80 gvfsd-fuse           1463            1296            1000            1000   0x000000001a0e0000 0
0xffff9636cf760000 ibus-daemon          1467            1296            1000            1000   0x0000000014180000 0
0xffff9636cf745b00 at-spi-bus-laun      1476            1296            1000            1000   0x000000001a144000 0
0xffff9636d4092d80 ibus-dconf           1483            1467            1000            1000   0x000000001087a000 0
0xffff9636d3815b00 ibus-ui-gtk3         1484            1467            1000            1000   0x000000001046a000 0
0xffff9636d72e0000 ibus-x11             1491            1296            1000            1000   0x000000001a162000 0
0xffff9636da070000 dbus-daemon          1494            1476            1000            1000   0x000000001e6f8000 0
0xffff9636d245ad80 at-spi2-registr      1497            1296            1000            1000   0x00000000171e4000 0
0xffff9636d25a5b00 ibus-engine-sim      1516            1467            1000            1000   0x0000000013956000 0
0xffff9636d25a4440 gpg-agent            1529            1296            1000            1000   0x0000000013a06000 0
0xffff9636d3ad8000 hud-service          1544            1296            1000            1000   0x00000000141d0000 0
0xffff9636d3a5ad80 unity-settings-      1546            1296            1000            1000   0x0000000012570000 0
0xffff9636d73b8000 gnome-session-b      1560            1296            1000            1000   0x0000000013a30000 0
0xffff9636cf80c440 unity-panel-ser      1573            1296            1000            1000   0x000000000f806000 0
0xffff9636cf94ad80 check_gl_textur      1595            1546            1000            1000   ------------------ 0
0xffff9636d2a65b00 dconf-service        1605            1296            1000            1000   0x0000000012a82000 0
0xffff9636d7215b00 indicator-messa      1612            1296            1000            1000   0x000000000f856000 0
0xffff9636d229db00 indicator-bluet      1614            1296            1000            1000   0x000000000f834000 0
0xffff9636cf94db00 indicator-power      1615            1296            1000            1000   0x000000000f88e000 0
0xffff9636cf9ec440 indicator-datet      1620            1296            1000            1000   0x000000000f92c000 0
0xffff9636cf9edb00 indicator-keybo      1621            1296            1000            1000   0x000000000f912000 0
0xffff9636cf918000 indicator-sound      1624            1296            1000            1000   0x0000000012b1a000 0
0xffff9636cf91c440 indicator-print      1625            1296            1000            1000   0x0000000012b98000 0
0xffff9636d2bd8000 indicator-sessi      1628            1296            1000            1000   0x000000001203e000 0
0xffff9636d20cc440 indicator-appli      1638            1296            1000            1000   0x00000000123ba000 0
0xffff9636d21e0000 gnome-screensav      1661            1296            1000            1000   0x0000000010228000 0
0xffff9636d0308000 pulseaudio           1667            1296            1000            1000   0x000000001036e000 0
0xffff9636d030db00 evolution-sourc      1668            1296            1000            1000   0x00000000103ee000 0
0xffff9636da072d80 evolution-calen      1718            1296            1000            1000   0x0000000012186000 0
0xffff9636d03096c0 nm-applet            1732            1560            1000            1000   0x000000001f03e000 0
0xffff9636d030ad80 nautilus             1733            1560            1000            1000   0x000000001e4c0000 0
0xffff9636d72e2d80 gnome-software       1734            1560            1000            1000   0x0000000010310000 0
0xffff9636d215ad80 polkit-gnome-au      1736            1560            1000            1000   0x00000000008e0000 0
0xffff9636c0094000 unity-fallback-      1738            1560            1000            1000   0x000000000af30000 0
0xffff9636c0912d80 evolution-calen      1767            1718            1000            1000   0x000000000091e000 0
0xffff9636c0914440 gvfs-udisks2-vo      1769            1296            1000            1000   0x00000000008f6000 0
0xffff9636c09b0000 udisksd              1773            1               0               0      0x000000000fb6a000 0
0xffff9636d73d5b00 gvfs-goa-volume      1783            1296            1000            1000   0x00000000009b8000 0
0xffff9636c0910000 gvfs-mtp-volume      1788            1296            1000            1000   0x0000000000904000 0
0xffff9636c8672d80 gvfs-afc-volume      1796            1296            1000            1000   0x0000000000908000 0
0xffff9636cf4cdb00 gvfs-gphoto2-vo      1808            1296            1000            1000   0x00000000079ba000 0
0xffff9636c8752d80 evolution-addre      1826            1296            1000            1000   0x000000000ff88000 0
0xffff9636cfec0000 evolution-calen      1831            1718            1000            1000   0x00000000008b6000 0
0xffff9636cfec4440 fwupd                1835            1               0               0      0x0000000019638000 0
0xffff9636c8755b00 evolution-addre      1847            1826            1000            1000   0x0000000015d1a000 0
0xffff9636d2bdad80 gvfsd-trash          1866            1296            1000            1000   0x000000001e4ac000 0
0xffff9636d9710000 zeitgeist-datah      1924            1560            1000            1000   0x000000000fab6000 0
0xffff9636c09b16c0 sh                   1931            1296            1000            1000   0x000000000096e000 0
0xffff9636c0188000 zeitgeist-daemo      1935            1931            1000            1000   0x0000000000100000 0
0xffff9636d21dad80 zeitgeist-fts        1942            1296            1000            1000   0x000000000014e000 0
0xffff9636d9714440 update-notifier      2058            1560            1000            1000   0x0000000019718000 0
0xffff9636c8670000 sshd                 2182            834             0               0      0x000000001e666000 0
0xffff9636d2158000 sshd                 2283            2182            1000            1000   0x00000000171de000 0
0xffff9636d20a5b00 sftp-server          2284            2283            1000            1000   0x000000001e662000 0
0xffff9636d3addb00 deja-dup-monito      2302            1560            1000            1000   0x000000000dd40000 0
0xffff9636d40916c0 bash                 7682            2283            1000            1000   0x0000000010426000 0
0xffff9636d9734440 kworker/0:1          9262            2               0               0      ------------------ 0
0xffff9636d3adad80 sudo                 11724           7682            0               1000   0x000000001e6fc000 0
0xffff9636cf9e96c0 su                   11756           11724           0               0      0x0000000014188000 0
0xffff9636cf76ad80 bash                 11757           11756           0               0      0x0000000019696000 0
0xffff9636de50ad80 runtime              14084           11757           0               0      0x000000000fb1e000 0
0xffff9636cf69ad80 sh                   14085           14084           0               0      ------------------ 0
0xffff9636d9730000 bash                 14159           2283            1000            1000   0x00000000190cc000 0
0xffff9636cf768000 sudo                 14232           14159           0               1000   0x00000000133c6000 0
0xffff9636db645b00 su                   14256           14232           0               0      0x0000000019394000 0
0xffff9636d030c440 bash                 14259           14256           0               0      0x000000000fb18000 0
0xffff9636da1fdb00 insmod               14862           14259           0               0      0x00000000190d2000 0
0xffff9636cf9ead80 bash                 14900           2283            1000            1000   0x0000000019068000 0
0xffff9636d9735b00 gmain                15037           15009           -1              -1     ------------------ 0
```

Based on the results presented above, we can see that rsyslog has the PID of `644`.


### 2.	How many threads were spawned by the process rsyslog?	[VERIFIED]

For this question, we will need to make use of `linux_threads`, which "Prints threads of processes", and we can either use the `-p` flag to specify the process id, to pipe the result and grep the name of the process as shown below.
The `-C` flag allows us to include lines above and below the specified line to grep for, so as to include all the threads in the process.

```
root@attackdefense:~# vol.py -f memory_dump.img linux_threads | grep -C 5 "rsyslog"
Volatility Foundation Volatility Framework 2.6.1
------------- ----------------
643           accounts-daemon 
646           gmain           
654           gdbus           

Process Name: rsyslogd
Process ID: 644
Thread PID    Thread Name     
------------- ----------------
644           rsyslogd        
648           in:imuxsock     
649           in:imklog       
650           rs:main Q:Reg   

Process Name: dbus-daemon
root@attackdefense:~# 
```

We can simply count the number of threads to get the flag.


### 3.	The insmod command which is used to insert kernel module, is fired from which directory? Provide absolute path.	[VERIFIED]

We are given the specific command used so we can just look for the corresponding `PID` in our previous linux pslist and thereafter, use that to filter the directory using `linux_getcwd`.

```
root@attackdefense:~# vol.py -f memory_dump.img linux_getcwd -p 14862             
Volatility Foundation Volatility Framework 2.6.1
Name              Pid      CWD
----------------- -------- ---
insmod               14862 /root/LiME/src
root@attackdefense:~# 
```

### 4.	What is the name of the parent process of process 'upstart'?	[VERIFIED]

We can also refer back to the output of Q1 for this. `upstart` has a `PPID` of `1073`, which corresponds to the process `lightdm`.


### 5.	What is the MAC address of the machine which had IP address 192.168.8.167 assigned to it?	[VERIFIED]

When first attempting this, I thought it had to do with the interface configuration since i usually use the too and the mac address is usuaully listed for the corresponding ip address but 
`192.168.8.167` wasn't listed to I re-read the available options as shown with `vol.py -h`. (Since it was good to explore the local machine IP configurations before moving on to LAN, LAN to WAN, WAN and so forth if need be).

```
root@attackdefense:~# vol.py -f memory_dump.img linux_ifconfig      
Volatility Foundation Volatility Framework 2.6.1
Interface        IP Address           MAC Address        Promiscous Mode
---------------- -------------------- ------------------ ---------------
lo               127.0.0.1            00:00:00:00:00:00  False          
enp0s3           192.168.8.123        08:00:27:c9:d7:c0  False          
lo               127.0.0.1            00:00:00:00:00:00  False   
```

Since a few of the previos challenges pointed to the LiME tool, i decided to use limeinfo to check if there was any interesting information (to my dismay).

Thereafter, I used `linux_arp`, recalling that we can be able to pick up LAN connections using tools like `arp-scan` from my hacking module.

```
root@attackdefense:~# vol.py -f memory_dump.img limeinfo
Volatility Foundation Volatility Framework 2.6.1
Memory Start       Memory End         Size              
------------------ ------------------ ------------------
0x0000000000001000 0x000000000009fbff 0x000000000009ec00
0x0000000000100000 0x000000001ffeffff 0x000000001fef0000

root@attackdefense:~# vol.py -f memory_dump.img linux_arp
Volatility Foundation Volatility Framework 2.6.1
[255.255.255.255                           ] at ff:ff:ff:ff:ff:ff    on enp0s3
[192.168.8.255                             ] at ff:ff:ff:ff:ff:ff    on enp0s3
[224.0.0.251                               ] at 01:00:5e:00:00:fb    on enp0s3
[192.168.8.1                               ] at e4:95:6e:44:3b:b1    on enp0s3
[192.168.8.206                             ] at 34:e6:ad:56:e1:04    on enp0s3
[192.168.8.167                             ] at d0:04:01:01:fd:ba    on enp0s3
[224.0.0.22                                ] at 01:00:5e:00:00:16    on enp0s3
[0.0.0.0                                   ] at 00:00:00:00:00:00    on lo
[ff02::1                                   ] at 33:33:00:00:00:01    on enp0s3
[ff02::1:fffe:d687                         ] at 33:33:ff:fe:d6:87    on enp0s3
[ff02::2                                   ] at 33:33:00:00:00:02    on enp0s3
[ff02::fb                                  ] at 33:33:00:00:00:fb    on enp0s3
[ff02::16                                  ] at 33:33:00:00:00:16    on enp0s3
[::1                                       ] at 00:00:00:00:00:00    on lo
```

And indeed, we have found the corresponding MAC address which is `d0:04:01:01:fd:ba`.

### 6.	The memory dump was taken using LiME tool using a TCP socket. What is the port number used for this socket?	[VERIFIED]

I spent quite a while on this question trying to put my finger on the argument to use. `linux_netscan` was unavailable and couldn't be run on the vm since `yara` wasn't installed. `yara` couldn't be installed... lol ok.

Thereafter I tried `linux_netstat` and tried to search for the TCP ports in use but those weren't the right answer!

```
root@attackdefense:~# vol.py -f memory_dump.img linux_netstat
Volatility Foundation Volatility Framework 2.6.1
UNIX 12472              systemd/1     /run/systemd/notify
UNIX 12473              systemd/1     /run/systemd/private
UNIX 21295              systemd/1     /run/systemd/journal/stdout
UNIX 21296              systemd/1     /run/systemd/journal/stdout
UNIX 21349              systemd/1     /run/systemd/journal/stdout
UNIX 21351              systemd/1     /run/systemd/journal/stdout
UNIX 12477              systemd/1     /run/systemd/journal/stdout
UNIX 12478              systemd/1     /run/systemd/journal/socket
UNIX 20181              systemd/1     
UNIX 12485              systemd/1     /run/systemd/journal/dev-log
UNIX 12486              systemd/1     /run/systemd/journal/syslog
UNIX 12493              systemd/1     /run/systemd/fsck.progress
UNIX 12633              systemd/1     /run/udev/control
UNIX 13205              systemd/1     /run/systemd/journal/stdout
UNIX 13145              systemd/1     
UNIX 15369              systemd/1     /run/uuidd/request
UNIX 15370              systemd/1     /var/run/avahi-daemon/socket
UNIX 14932              systemd/1     /run/systemd/journal/stdout
UNIX 22739              systemd/1     /run/systemd/journal/stdout
UNIX 20872              systemd/1     /run/systemd/journal/stdout
UNIX 15372              systemd/1     /run/snapd.socket
UNIX 15373              systemd/1     /run/snapd-snap.socket
UNIX 15374              systemd/1     /run/acpid.socket
UNIX 15375              systemd/1     /var/run/cups/cups.sock
UNIX 15376              systemd/1     /var/run/dbus/system_bus_socket
UNIX 16408              systemd/1     
UNIX 19623              systemd/1     /run/systemd/journal/stdout
UNIX 17782              systemd/1     /run/systemd/journal/stdout
UNIX 18197              systemd/1     /run/systemd/journal/stdout
UNIX 22741              systemd/1     /run/systemd/journal/stdout
UNIX 15685              systemd/1     /run/systemd/journal/stdout
UNIX 23095              systemd/1     /run/systemd/journal/stdout
UNIX 23097              systemd/1     /run/systemd/journal/stdout
UNIX 16007              systemd/1     /run/systemd/journal/stdout
UNIX 16070              systemd/1     /run/systemd/journal/stdout
UNIX 21457              systemd/1     /run/systemd/journal/stdout
UNIX 21458              systemd/1     /run/systemd/journal/stdout
UNIX 16374              systemd/1     /run/systemd/journal/stdout
UNIX 16405              systemd/1     /run/systemd/journal/stdout
UNIX 16465              systemd/1     /run/systemd/journal/stdout
UNIX 16605              systemd/1     /run/systemd/journal/stdout
UNIX 16721              systemd/1     /run/systemd/journal/stdout
UNIX 22065              systemd/1     /run/systemd/journal/stdout
UNIX 22164              systemd/1     /run/systemd/journal/stdout
UNIX 22165              systemd/1     /run/systemd/journal/stdout
UNIX 22285              systemd/1     /run/systemd/journal/stdout
UNIX 20182              systemd/1     
UNIX 20278              systemd/1     /run/systemd/journal/stdout
UNIX 20485              systemd/1     /run/systemd/journal/stdout
UNIX 20615              systemd/1     /run/systemd/journal/stdout
UNIX 22287              systemd/1     /run/systemd/journal/stdout
UNIX 22316              systemd/1     /run/systemd/journal/stdout
UNIX 22318              systemd/1     /run/systemd/journal/stdout
UNIX 23265              systemd/1     /run/systemd/journal/stdout
UNIX 23267              systemd/1     /run/systemd/journal/stdout
UNIX 23279              systemd/1     /run/systemd/journal/stdout
UNIX 23281              systemd/1     /run/systemd/journal/stdout
UNIX 23300              systemd/1     /run/systemd/journal/stdout
UNIX 23302              systemd/1     /run/systemd/journal/stdout
UNIX 23820              systemd/1     /run/systemd/journal/stdout
UNIX 23427              systemd/1     /run/systemd/journal/stdout
UNIX 23429              systemd/1     /run/systemd/journal/stdout
UNIX 23470              systemd/1     /run/systemd/journal/stdout
UNIX 23472              systemd/1     /run/systemd/journal/stdout
UNIX 23615              systemd/1     /run/systemd/journal/stdout
UNIX 23822              systemd/1     /run/systemd/journal/stdout
UNIX 23837              systemd/1     /run/systemd/journal/stdout
UNIX 23839              systemd/1     /run/systemd/journal/stdout
UNIX 12477      systemd-journal/216   /run/systemd/journal/stdout
UNIX 12478      systemd-journal/216   /run/systemd/journal/socket
UNIX 12485      systemd-journal/216   /run/systemd/journal/dev-log
UNIX 12916      systemd-journal/216   
UNIX 20872      systemd-journal/216   /run/systemd/journal/stdout
UNIX 13205      systemd-journal/216   /run/systemd/journal/stdout
UNIX 19623      systemd-journal/216   /run/systemd/journal/stdout
UNIX 16374      systemd-journal/216   /run/systemd/journal/stdout
UNIX 17782      systemd-journal/216   /run/systemd/journal/stdout
UNIX 14932      systemd-journal/216   /run/systemd/journal/stdout
UNIX 15685      systemd-journal/216   /run/systemd/journal/stdout
UNIX 18197      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22739      systemd-journal/216   /run/systemd/journal/stdout
UNIX 16007      systemd-journal/216   /run/systemd/journal/stdout
UNIX 16070      systemd-journal/216   /run/systemd/journal/stdout
UNIX 16605      systemd-journal/216   /run/systemd/journal/stdout
UNIX 21295      systemd-journal/216   /run/systemd/journal/stdout
UNIX 16405      systemd-journal/216   /run/systemd/journal/stdout
UNIX 16465      systemd-journal/216   /run/systemd/journal/stdout
UNIX 16721      systemd-journal/216   /run/systemd/journal/stdout
UNIX 21296      systemd-journal/216   /run/systemd/journal/stdout
UNIX 21349      systemd-journal/216   /run/systemd/journal/stdout
UNIX 21351      systemd-journal/216   /run/systemd/journal/stdout
UNIX 21457      systemd-journal/216   /run/systemd/journal/stdout
UNIX 21458      systemd-journal/216   /run/systemd/journal/stdout
UNIX 20278      systemd-journal/216   /run/systemd/journal/stdout
UNIX 20485      systemd-journal/216   /run/systemd/journal/stdout
UNIX 20615      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22065      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22164      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22165      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22285      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22287      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22316      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22318      systemd-journal/216   /run/systemd/journal/stdout
UNIX 22741      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23095      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23097      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23265      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23267      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23279      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23281      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23300      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23302      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23820      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23427      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23429      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23470      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23472      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23615      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23822      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23837      systemd-journal/216   /run/systemd/journal/stdout
UNIX 23839      systemd-journal/216   /run/systemd/journal/stdout
UNIX 13203        systemd-udevd/239   
UNIX 13203        systemd-udevd/239   
UNIX 12633        systemd-udevd/239   /run/udev/control
UNIX 13335        systemd-udevd/239   
UNIX 13412        systemd-udevd/239   
UNIX 13413        systemd-udevd/239   
UNIX 14930      systemd-timesyn/491   
UNIX 14930      systemd-timesyn/491   
UNIX 14951      systemd-timesyn/491   
UNIX 14955      systemd-timesyn/491   
UNIX 14956      systemd-timesyn/491   
UNIX 14957      systemd-timesyn/491   
UNIX 14958      systemd-timesyn/491   
UNIX 15684       systemd-logind/617   
UNIX 15684       systemd-logind/617   
UNIX 15745       systemd-logind/617   
UNIX 15751       systemd-logind/617   
UNIX 15374                acpid/629   /run/acpid.socket
UNIX 15879                acpid/629   
UNIX 16006         avahi-daemon/632   
UNIX 16006         avahi-daemon/632   
UNIX 15370         avahi-daemon/632   /var/run/avahi-daemon/socket
UNIX 16209         avahi-daemon/632   
UNIX 16218         avahi-daemon/632   
UNIX 16229         avahi-daemon/632   
UDP      0.0.0.0         : 5353 0.0.0.0         :    0                      avahi-daemon/632  
UDP      ::              : 5353 ::              :    0                      avahi-daemon/632  
UDP      0.0.0.0         :47244 0.0.0.0         :    0                      avahi-daemon/632  
UDP      ::              :38483 ::              :    0                      avahi-daemon/632  
UNIX 16069                cupsd/635   
UNIX 16069                cupsd/635   
UNIX 15375                cupsd/635   /var/run/cups/cups.sock
UNIX 16862                cupsd/635   
TCP      ::1             :  631 ::              :    0 LISTEN                      cupsd/635  
TCP      127.0.0.1       :  631 0.0.0.0         :    0 LISTEN                      cupsd/635  
UNIX 16006         avahi-daemon/640   
UNIX 16006         avahi-daemon/640   
UNIX 15370         avahi-daemon/640   /var/run/avahi-daemon/socket
UNIX 16209         avahi-daemon/640   
UNIX 16219         avahi-daemon/640   
UNIX 16373                 cron/642   
UNIX 16373                 cron/642   
UNIX 16404      accounts-daemon/643   
UNIX 16404      accounts-daemon/643   
UNIX 16484      accounts-daemon/643   
UNIX 12486             rsyslogd/644   /run/systemd/journal/syslog
UNIX 16464          dbus-daemon/645   
UNIX 16464          dbus-daemon/645   
UNIX 15376          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 16501          dbus-daemon/645   
UNIX 16504          dbus-daemon/645   
UNIX 16505          dbus-daemon/645   
UNIX 16506          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 16507          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 16863          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 16509          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 16510          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 17091          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 17095          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 17108          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 17121          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 17132          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 17178          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 20694          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 17705          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 21058          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 17814          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22509          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 18268          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 18391          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 21179          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 21479          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22053          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22198          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22203          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22222          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22231          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 20034          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 20065          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22265          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 20284          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23118          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22267          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22441          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 20499          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22357          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 20622          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 22723          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23230          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23728          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23274          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23305          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23456          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23507          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23643          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23832          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 23882          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 27590          dbus-daemon/645   /var/run/dbus/system_bus_socket
UNIX 16603       NetworkManager/656   
UNIX 16603       NetworkManager/656   
UNIX 17145       NetworkManager/656   
UNIX 17177       NetworkManager/656   
UNIX 18280       NetworkManager/656   /var/run/NetworkManager/private-dhcp
UNIX 16670         cups-browsed/658   
UNIX 16670         cups-browsed/658   
UNIX 17111         cups-browsed/658   
UNIX 17158         cups-browsed/658   
UNIX 17120         cups-browsed/658   
UDP      0.0.0.0         :  631 0.0.0.0         :    0                      cups-browsed/658  
UNIX 17131         cups-browsed/658   
UNIX 17094                 dbus/664   
UNIX 17090                 dbus/665   
UNIX 17107                 dbus/666   
UNIX 17703              polkitd/780   
UNIX 23290              polkitd/780   
UNIX 17781              lightdm/802   
UNIX 17781              lightdm/802   
UNIX 17813              lightdm/802   
UNIX 18943              lightdm/802   
UNIX 18254                 Xorg/833   
UNIX 18255                 Xorg/833   /tmp/.X11-unix/X0
UNIX 19054                 Xorg/833   
UNIX 18267                 Xorg/833   
UNIX 21284                 Xorg/833   
UNIX 21475                 Xorg/833   
UNIX 21481                 Xorg/833   
UNIX 21485                 Xorg/833   
UNIX 21996                 Xorg/833   
UNIX 22003                 Xorg/833   
UNIX 22243                 Xorg/833   
UNIX 22045                 Xorg/833   
UNIX 22270                 Xorg/833   
UNIX 24327                 Xorg/833   
UNIX 22480                 Xorg/833   
UNIX 22858                 Xorg/833   
UNIX 23045                 Xorg/833   
UNIX 24019                 Xorg/833   
UNIX 23062                 Xorg/833   
UNIX 23066                 Xorg/833   
UNIX 23448                 Xorg/833   
UNIX 18196                 sshd/834   
UNIX 18196                 sshd/834   
TCP      0.0.0.0         :   22 0.0.0.0         :    0 LISTEN                       sshd/834  
TCP      ::              :   22 ::              :    0 LISTEN                       sshd/834  
UNIX 18337             dhclient/844   
UDP      0.0.0.0         :   68 0.0.0.0         :    0                          dhclient/844  
UDP      127.0.1.1       :   53 0.0.0.0         :    0                           dnsmasq/857  
TCP      127.0.1.1       :   53 0.0.0.0         :    0 LISTEN                    dnsmasq/857  
UNIX 18390              dnsmasq/857   
UNIX 18398              dnsmasq/857   
UDP      0.0.0.0         :58487 0.0.0.0         :    0                           dnsmasq/857  
UNIX 17781              lightdm/1073  
UNIX 19404              lightdm/1073  
UNIX 20693              lightdm/1073  
UNIX 19622             whoopsie/1103  
UNIX 19622             whoopsie/1103  
UNIX 20033             whoopsie/1103  
UNIX 20064             whoopsie/1103  
UNIX 20262         rtkit-daemon/1151  
UNIX 20262         rtkit-daemon/1151  
UNIX 20282         rtkit-daemon/1151  
UNIX 20283         rtkit-daemon/1151  
UNIX 20484              upowerd/1168  
UNIX 20484              upowerd/1168  
UNIX 20498              upowerd/1168  
UNIX 20614               colord/1181  
UNIX 20614               colord/1181  
UNIX 20621               colord/1181  
UNIX 20868              systemd/1222  
UNIX 20868              systemd/1222  
UNIX 20891              systemd/1222  
UNIX 20957              systemd/1222  /run/user/1000/systemd/notify
UNIX 20958              systemd/1222  /run/user/1000/systemd/private
UNIX 20868             (sd-pam)/1224  
UNIX 20868             (sd-pam)/1224  
UNIX 20875             (sd-pam)/1224  
UNIX 20979      gnome-keyring-d/1292  /run/user/1000/keyring/control
UNIX 21245      gnome-keyring-d/1292  /run/user/1000/keyring/ssh
UNIX 21214      gnome-keyring-d/1292  
UNIX 21223      gnome-keyring-d/1292  
UNIX 21243      gnome-keyring-d/1292  /run/user/1000/keyring/pkcs11
UNIX 21056              upstart/1296  
UNIX 21057              upstart/1296  
UNIX 21077              upstart/1296  
UNIX 21142              upstart/1296  
UNIX 21189              upstart/1296  
UNIX 21195              upstart/1296  
UNIX 21199              upstart/1296  
UNIX 21074      upstart-udev-br/1379  
UNIX 21126          dbus-daemon/1390  
UNIX 21136          dbus-daemon/1390  
UNIX 21137          dbus-daemon/1390  
UNIX 21143          dbus-daemon/1390  
UNIX 21171          dbus-daemon/1390  
UNIX 21227          dbus-daemon/1390  
UNIX 21230          dbus-daemon/1390  
UNIX 21288          dbus-daemon/1390  
UNIX 21298          dbus-daemon/1390  
UNIX 21339          dbus-daemon/1390  
UNIX 21344          dbus-daemon/1390  
UNIX 21362          dbus-daemon/1390  
UNIX 21399          dbus-daemon/1390  
UNIX 21477          dbus-daemon/1390  
UNIX 21404          dbus-daemon/1390  
UNIX 21488          dbus-daemon/1390  
UNIX 21490          dbus-daemon/1390  
UNIX 22001          dbus-daemon/1390  
UNIX 24330          dbus-daemon/1390  
UNIX 21544          dbus-daemon/1390  
UNIX 22050          dbus-daemon/1390  
UNIX 22035          dbus-daemon/1390  
UNIX 22058          dbus-daemon/1390  
UNIX 22200          dbus-daemon/1390  
UNIX 22121          dbus-daemon/1390  
UNIX 22235          dbus-daemon/1390  
UNIX 22167          dbus-daemon/1390  
UNIX 22211          dbus-daemon/1390  
UNIX 22214          dbus-daemon/1390  
UNIX 22224          dbus-daemon/1390  
UNIX 22226          dbus-daemon/1390  
UNIX 22342          dbus-daemon/1390  
UNIX 23708          dbus-daemon/1390  
UNIX 23051          dbus-daemon/1390  
UNIX 22344          dbus-daemon/1390  
UNIX 23054          dbus-daemon/1390  
UNIX 22347          dbus-daemon/1390  
UNIX 22423          dbus-daemon/1390  
UNIX 22431          dbus-daemon/1390  
UNIX 22484          dbus-daemon/1390  
UNIX 22488          dbus-daemon/1390  
UNIX 22721          dbus-daemon/1390  
UNIX 23249          dbus-daemon/1390  
UNIX 23073          dbus-daemon/1390  
UNIX 23076          dbus-daemon/1390  
UNIX 23081          dbus-daemon/1390  
UNIX 23083          dbus-daemon/1390  
UNIX 23270          dbus-daemon/1390  
UNIX 23293          dbus-daemon/1390  
UNIX 23417          dbus-daemon/1390  
UNIX 23443          dbus-daemon/1390  
UNIX 23432          dbus-daemon/1390  
UNIX 23618          dbus-daemon/1390  
UNIX 23646          dbus-daemon/1390  
UNIX 23711          dbus-daemon/1390  
UNIX 23814          dbus-daemon/1390  
UNIX 23828          dbus-daemon/1390  
UNIX 23861          dbus-daemon/1390  
UNIX 27586          dbus-daemon/1390  
UNIX 21226      window-stack-br/1402  
UNIX 21283           bamfdaemon/1444  
UNIX 21287           bamfdaemon/1444  
UNIX 21342           bamfdaemon/1444  
UNIX 21445           bamfdaemon/1444  
UNIX 21170      upstart-dbus-br/1450  
UNIX 21176      upstart-dbus-br/1450  
UNIX 21178      upstart-dbus-br/1452  
UNIX 21183      upstart-dbus-br/1452  
UNIX 21197      upstart-file-br/1454  
UNIX 21292                gvfsd/1458  
UNIX 21293                gvfsd/1458  
UNIX 21297                gvfsd/1458  
UNIX 21338           gvfsd-fuse/1463  
UNIX 21357          ibus-daemon/1467  
UNIX 21369          ibus-daemon/1467  
UNIX 21461          ibus-daemon/1467  
UNIX 21506          ibus-daemon/1467  
UNIX 21512          ibus-daemon/1467  
UNIX 21547          ibus-daemon/1467  
UNIX 22089          ibus-daemon/1467  
UNIX 22688          ibus-daemon/1467  
UNIX 23651          ibus-daemon/1467  
UNIX 21348      at-spi-bus-laun/1476  
UNIX 21350      at-spi-bus-laun/1476  
UNIX 21403      at-spi-bus-laun/1476  
UNIX 21398           ibus-dconf/1483  
UNIX 21460           ibus-dconf/1483  
UNIX 21478           ibus-dconf/1483  
UNIX 21484         ibus-ui-gtk3/1484  
UNIX 21489         ibus-ui-gtk3/1484  
UNIX 21509         ibus-ui-gtk3/1484  
UNIX 21511         ibus-ui-gtk3/1484  
UNIX 21480             ibus-x11/1491  
UNIX 21487             ibus-x11/1491  
UNIX 21503             ibus-x11/1491  
UNIX 21505             ibus-x11/1491  
UNIX 21348          dbus-daemon/1494  
UNIX 21350          dbus-daemon/1494  
UNIX 21442          dbus-daemon/1494  
UNIX 21449          dbus-daemon/1494  
UNIX 21450          dbus-daemon/1494  
UNIX 21451          dbus-daemon/1494  
UNIX 21467          dbus-daemon/1494  
UNIX 21504          dbus-daemon/1494  
UNIX 21510          dbus-daemon/1494  
UNIX 22029          dbus-daemon/1494  
UNIX 24334          dbus-daemon/1494  
UNIX 22031          dbus-daemon/1494  
UNIX 22435          dbus-daemon/1494  
UNIX 22173          dbus-daemon/1494  
UNIX 22448          dbus-daemon/1494  
UNIX 22543          dbus-daemon/1494  
UNIX 23071          dbus-daemon/1494  
UNIX 23114          dbus-daemon/1494  
UNIX 23128          dbus-daemon/1494  
UNIX 24027          dbus-daemon/1494  
UNIX 23458          dbus-daemon/1494  
UNIX 21455      at-spi2-registr/1497  
UNIX 21456      at-spi2-registr/1497  
UNIX 21466      at-spi2-registr/1497  
UNIX 21474      at-spi2-registr/1497  
UNIX 21476      at-spi2-registr/1497  
UNIX 21543      ibus-engine-sim/1516  
UNIX 21546      ibus-engine-sim/1516  
UNIX 21700            gpg-agent/1529  /home/osboxes/.gnupg/S.gpg-agent
UNIX 22002          hud-service/1544  
UNIX 22028          hud-service/1544  
UNIX 22034          hud-service/1544  
UNIX 22088          hud-service/1544  
UNIX 22120          hud-service/1544  
UNIX 22127          hud-service/1544  
UNIX 22128          hud-service/1544  
UNIX 22129          hud-service/1544  
UNIX 22130          hud-service/1544  
UNIX 21995      unity-settings-/1546  
UNIX 22000      unity-settings-/1546  
UNIX 22030      unity-settings-/1546  
UNIX 22052      unity-settings-/1546  
UNIX 22536      unity-settings-/1546  
UNIX 22687      unity-settings-/1546  
UNIX 22064      gnome-session-b/1560  
UNIX 22064      gnome-session-b/1560  
UNIX 22064      gnome-session-b/1560  
UNIX 22049      gnome-session-b/1560  
UNIX 22350      gnome-session-b/1560  
UNIX 22732      gnome-session-b/1560  
UNIX 22733      gnome-session-b/1560  /tmp/.ICE-unix/1560
UNIX 22889      gnome-session-b/1560  
UNIX 23042      gnome-session-b/1560  
UNIX 22044      unity-panel-ser/1573  
UNIX 22057      unity-panel-ser/1573  
UNIX 22172      unity-panel-ser/1573  
UNIX 22161        dconf-service/1605  
UNIX 22162        dconf-service/1605  
UNIX 22166        dconf-service/1605  
UNIX 22199      indicator-messa/1612  
UNIX 22202      indicator-messa/1612  
UNIX 22197      indicator-bluet/1614  
UNIX 22210      indicator-bluet/1614  
UNIX 22230      indicator-power/1615  
UNIX 22233      indicator-power/1615  
UNIX 22225      indicator-datet/1620  
UNIX 22264      indicator-datet/1620  
UNIX 22242      indicator-keybo/1621  
UNIX 22303      indicator-keybo/1621  
UNIX 22445      indicator-keybo/1621  
UNIX 22213      indicator-sound/1624  
UNIX 22221      indicator-sound/1624  
UNIX 22514      indicator-sound/1624  
UNIX 22534      indicator-sound/1624  
UNIX 22269      indicator-print/1625  
UNIX 22311      indicator-print/1625  
UNIX 22434      indicator-print/1625  
UNIX 22446      indicator-print/1625  
UNIX 22440      indicator-print/1625  
UNIX 22223      indicator-sessi/1628  
UNIX 22266      indicator-sessi/1628  
UNIX 22319      indicator-appli/1638  
UNIX 22430      indicator-appli/1638  
UNIX 22284      gnome-screensav/1661  
UNIX 22286      gnome-screensav/1661  
UNIX 22479      gnome-screensav/1661  
UNIX 22487      gnome-screensav/1661  
UNIX 22542      gnome-screensav/1661  
UNIX 22720      gnome-screensav/1661  
UNIX 22722      gnome-screensav/1661  
UNIX 22526           pulseaudio/1667  /run/user/1000/pulse/native
UNIX 22535           pulseaudio/1667  /run/user/1000/pulse/native
UNIX 22392           pulseaudio/1667  
UNIX 22489           pulseaudio/1667  
UNIX 22508           pulseaudio/1667  
UNIX 22511           pulseaudio/1667  /run/user/1000/pulse/native
UNIX 22538           pulseaudio/1667  /run/user/1000/pulse/native
UNIX 22857           pulseaudio/1667  
UNIX 22888           pulseaudio/1667  
UNIX 22315      evolution-sourc/1668  
UNIX 22317      evolution-sourc/1668  
UNIX 22483      evolution-sourc/1668  
UNIX 22738      evolution-calen/1718  
UNIX 22740      evolution-calen/1718  
UNIX 23082      evolution-calen/1718  
UNIX 22064            nm-applet/1732  
UNIX 22064            nm-applet/1732  
UNIX 23044            nm-applet/1732  
UNIX 23053            nm-applet/1732  
UNIX 23070            nm-applet/1732  
UNIX 23304            nm-applet/1732  
UNIX 22064             nautilus/1733  
UNIX 22064             nautilus/1733  
UNIX 23072             nautilus/1733  
UNIX 23447             nautilus/1733  
UNIX 23457             nautilus/1733  
UNIX 23650             nautilus/1733  
UNIX 23730             nautilus/1733  
UNIX 23723             nautilus/1733  
UNIX 22064       gnome-software/1734  
UNIX 22064       gnome-software/1734  
UNIX 23050       gnome-software/1734  
UNIX 24018       gnome-software/1734  
UNIX 23506       gnome-software/1734  
UNIX 24026       gnome-software/1734  
UNIX 22064      polkit-gnome-au/1736  
UNIX 22064      polkit-gnome-au/1736  
UNIX 23065      polkit-gnome-au/1736  
UNIX 23075      polkit-gnome-au/1736  
UNIX 23113      polkit-gnome-au/1736  
UNIX 23273      polkit-gnome-au/1736  
UNIX 22064      unity-fallback-/1738  
UNIX 22064      unity-fallback-/1738  
UNIX 23061      unity-fallback-/1738  
UNIX 23080      unity-fallback-/1738  
UNIX 23127      unity-fallback-/1738  
UNIX 22738      evolution-calen/1767  
UNIX 22740      evolution-calen/1767  
UNIX 23431      evolution-calen/1767  
UNIX 23455      evolution-calen/1767  
UNIX 23094      gvfs-udisks2-vo/1769  
UNIX 23096      gvfs-udisks2-vo/1769  
UNIX 23117      gvfs-udisks2-vo/1769  
UNIX 23248      gvfs-udisks2-vo/1769  
UNIX 23221              udisksd/1773  
UNIX 23229              udisksd/1773  
UNIX 23264      gvfs-goa-volume/1783  
UNIX 23266      gvfs-goa-volume/1783  
UNIX 23269      gvfs-goa-volume/1783  
UNIX 23278      gvfs-mtp-volume/1788  
UNIX 23280      gvfs-mtp-volume/1788  
UNIX 23292      gvfs-mtp-volume/1788  
UNIX 23299      gvfs-afc-volume/1796  
UNIX 23301      gvfs-afc-volume/1796  
UNIX 23416      gvfs-afc-volume/1796  
UNIX 23426      gvfs-gphoto2-vo/1808  
UNIX 23428      gvfs-gphoto2-vo/1808  
UNIX 23442      gvfs-gphoto2-vo/1808  
UNIX 23469      evolution-addre/1826  
UNIX 23471      evolution-addre/1826  
UNIX 23617      evolution-addre/1826  
UNIX 22738      evolution-calen/1831  
UNIX 22740      evolution-calen/1831  
UNIX 23707      evolution-calen/1831  
UNIX 23727      evolution-calen/1831  
UNIX 23614                fwupd/1835  
UNIX 23614                fwupd/1835  
UNIX 23881                fwupd/1835  
UNIX 23469      evolution-addre/1847  
UNIX 23471      evolution-addre/1847  
UNIX 23642      evolution-addre/1847  
UNIX 23645      evolution-addre/1847  
UNIX 21292          gvfsd-trash/1866  
UNIX 21293          gvfsd-trash/1866  
UNIX 23710          gvfsd-trash/1866  
UNIX 23724          gvfsd-trash/1866  
UNIX 23731          gvfsd-trash/1866  
UNIX 22064      zeitgeist-datah/1924  
UNIX 22064      zeitgeist-datah/1924  
UNIX 23813      zeitgeist-datah/1924  
UNIX 23819                   sh/1931  
UNIX 23821                   sh/1931  
UNIX 23819      zeitgeist-daemo/1935  
UNIX 23821      zeitgeist-daemo/1935  
UNIX 23827      zeitgeist-daemo/1935  
UNIX 23831      zeitgeist-daemo/1935  
UNIX 23836        zeitgeist-fts/1942  
UNIX 23838        zeitgeist-fts/1942  
UNIX 23860        zeitgeist-fts/1942  
UNIX 22064      update-notifier/2058  
UNIX 22064      update-notifier/2058  
UNIX 24326      update-notifier/2058  
UNIX 24329      update-notifier/2058  
UNIX 24333      update-notifier/2058  
TCP      192.168.8.123   :   22 192.168.8.206   :51370 ESTABLISHED                  sshd/2182 
UNIX 27312                 sshd/2182  
UNIX 27465                 sshd/2182  
TCP      192.168.8.123   :   22 192.168.8.206   :51370 ESTABLISHED                  sshd/2283 
UNIX 27312                 sshd/2283  
UNIX 27464                 sshd/2283  
UNIX 22064      deja-dup-monito/2302  
UNIX 22064      deja-dup-monito/2302  
UNIX 27585      deja-dup-monito/2302  
UNIX 27589      deja-dup-monito/2302  
UNIX 63197                 sudo/11724 
UNIX 63200                 sudo/11724 
UNIX 63217                   su/11756 
UNIX 72744                 sudo/14232 
UNIX 72747                 sudo/14232 
UNIX 72765                   su/14256 
root@attackdefense:~# 
```

Thereafter, my teammate, the volatility expert found it using `linux_bash`, which contains the bash history. 
```
root@attackdefense:~# vol.py -f memory_dump.img linux_bash
Volatility Foundation Volatility Framework 2.6.1
Pid      Name                 Command Time                   Command
-------- -------------------- ------------------------------ -------
   11757 bash                 2019-06-25 14:21:17 UTC+0000   ./Downloads/runtime 
   14159 bash                 2019-06-25 14:21:28 UTC+0000   sudo su
   14159 bash                 2019-06-25 14:21:28 UTC+0000   sudo su
   14259 bash                 2019-06-25 14:21:33 UTC+0000   exit
   14259 bash                 2019-06-25 14:21:33 UTC+0000   exit
   14259 bash                 2019-06-25 14:21:33 UTC+0000   ./runtime 
   14259 bash                 2019-06-25 14:21:33 UTC+0000   insmod lime-4.15.0-45-generic.ko "path=tcp:5000 format=lime"
   14259 bash                 2019-06-25 14:21:33 UTC+0000   cd ~
   14259 bash                 2019-06-25 14:21:33 UTC+0000   cd LiME/src/
   14259 bash                 2019-06-25 14:21:33 UTC+0000   ls -l
   14259 bash                 2019-06-25 14:21:33 UTC+0000   exit
   14259 bash                 2019-06-25 14:21:33 UTC+0000   ls -l
   14259 bash                 2019-06-25 14:21:40 UTC+0000   cd /root/LiME/src/
   14259 bash                 2019-06-25 14:22:11 UTC+0000   insmod lime-4.15.0-45-generic.ko "path=tcp:5000 format=lime"
   14259 bash                 2019-06-25 14:22:24 UTC+0000   rmmod lime
   14259 bash                 2019-06-25 14:22:26 UTC+0000   insmod lime-4.15.0-45-generic.ko "path=tcp:5000 format=lime"
   14900 bash                 2019-06-25 14:22:31 UTC+0000   sudo su
   14900 bash                 2019-06-25 14:22:31 UTC+0000   sudo su
   14900 bash                 2019-06-25 14:22:38 UTC+0000   nc localhost 5000 > memory_dump.img
root@attackdefense:~# 
```

Well... guess command line host based indicators are super important in forensics too. TIL.

### 7.	What was the mount point for /dev/sda2?	[VERIFIED]

Reading the question already gave a hint... So we can use `linux_mount` to view the previous and current partitions mounted at the time of the memory dump.

```
root@attackdefense:~# vol.py -f memory_dump.img linux_mount  
Volatility Foundation Volatility Framework 2.6.1
/dev/sda1                 /                                   ext4         rw,relatime                                                       
/dev/sda2                 /boot                               ext4         rw,relatime                                                       
cgroup                    /sys/fs/cgroup/cpu,cpuacct          cgroup       rw,relatime,nosuid,nodev,noexec                                   
hugetlbfs                 /dev/hugepages                      hugetlbfs    rw,relatime                                                       
cgroup                    /sys/fs/cgroup/freezer              cgroup       rw,relatime,nosuid,nodev,noexec                                   
/??????                  /@?f?6???@?f?6???/!/               D          rw,relatime                                                       
tmpfs                     /sys/fs/cgroup                      tmpfs        ro,nosuid,nodev,noexec                                            
sysfs                     /sys                                sysfs        rw,relatime,nosuid,nodev,noexec                                   
tmpfs                     /root/inaccessible                  tmpfs        ro,relatime,nosuid,noexec                                         
cgroup                    /sys/fs/cgroup/memory               cgroup       rw,relatime,nosuid,nodev,noexec                                   
pstore                    /sys/fs/pstore                      pstore       rw,relatime,nosuid,nodev,noexec                                   
udev                      /dev                                devtmpfs     rw,relatime,nosuid                                                
systemd-1                 /proc/sys/fs/binfmt_misc            autofs       rw,relatime                                                       
cgroup                    /sys/fs/cgroup/net_cls,net_prio     cgroup       rw,relatime,nosuid,nodev,noexec                                   
cgroup                    /sys/fs/cgroup/cpuset               cgroup       rw,relatime,nosuid,nodev,noexec                                   
fusectl                   /sys/fs/fuse/connections            fusectl      rw,relatime                                                       
cgroup                    /sys/fs/cgroup/hugetlb              cgroup       rw,relatime,nosuid,nodev,noexec                                   
cgroup                    /sys/fs/cgroup/devices              cgroup       rw,relatime,nosuid,nodev,noexec                                   
cgroup                    /sys/fs/cgroup/blkio                cgroup       rw,relatime,nosuid,nodev,noexec                                   
tmpfs                     /run/user/1000                      tmpfs        rw,relatime,nosuid,nodev                                          
securityfs                /sys/kernel/security                securityfs   rw,relatime,nosuid,nodev,noexec                                   
configfs                  /sys/kernel/config                  configfs     rw,relatime                                                       
cgroup                    /sys/fs/cgroup/rdma                 cgroup       rw,relatime,nosuid,nodev,noexec                                   
mqueue                    /dev/mqueue                         mqueue       rw,relatime                                                       
tmpfs                     /dev                                tmpfs        rw,nosuid                                                         
gvfsd-fuse                /run/user/1000/gvfs                 fuse         rw,relatime,nosuid,nodev                                          
cgroup                    /sys/fs/cgroup/systemd              cgroup       rw,relatime,nosuid,nodev,noexec                                   
tmpfs                     /dev/shm                            tmpfs        rw,nosuid,nodev                                                   
devpts                    /dev/pts                            devpts       rw,relatime,nosuid,noexec                                         
debugfs                   /sys/kernel/debug                   debugfs      rw,relatime                                                       
cgroup                    /sys/fs/cgroup/pids                 cgroup       rw,relatime,nosuid,nodev,noexec                                   
cgroup                    /sys/fs/cgroup/perf_event           cgroup       rw,relatime,nosuid,nodev,noexec                                   
proc                      /proc                               proc         rw,relatime,nosuid,nodev,noexec                                   
tmpfs                     /run/lock                           tmpfs        rw,relatime,nosuid,nodev,noexec                                   
/dev/sda4                 /home                               ext4         rw,relatime 
```

### 8.	There is a kernel module which is used by a popular virtualization solution to provide additional services to guest OS. This module was running at the time of taking the memory capture. What is the name of that kernel module?	[VERIFIED]

My first guess would be VirtualBox or VMware, being the most popular virtualization software. I first did `linux_lsmod` without grep and only saw `vboxguest`. Then my teammate [Fai](https://github.com/fy-fy-fy) looked at it again and saw `vboxguest`... Lol should have grepped earlier or looked closer!

```
root@attackdefense:~# vol.py -f memory_dump.img linux_lsmod | grep "vbox"
Volatility Foundation Volatility Framework 2.6.1
ffffffffc05d95c0 vboxvideo 36864
ffffffffc04a5200 vboxguest 303104
```

## Reflections

As I didn't really have experience in the linux side of volatility, this challenge was really an eye-opener that involved lots of troubleshooting and persistence. I also realised the importance of team contribution since we could be blinded to some aspects when doing the challenge so some fresh perspectives from teammates can really help! 
